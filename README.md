# å–¶æ¥­æ”¯æ´ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ (Sales Support Agent)
**Agent 365 SDK ãƒ‡ãƒ¢ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³**

## ğŸ“‹ æ¦‚è¦

Teams ãƒãƒ£ãƒƒãƒˆã§ã€Œ@å–¶æ¥­æ”¯æ´ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€ä»Šé€±ã®å•†è«‡ã‚µãƒãƒªã‚’æ•™ãˆã¦ã€ã¨è©±ã—ã‹ã‘ã‚‹ã¨ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒ **Agent Identity** ã‚’ä½¿ã£ã¦å®‰å…¨ã« Microsoft 365 ãƒ‡ãƒ¼ã‚¿ã¸ã‚¢ã‚¯ã‚»ã‚¹ã—ã€ãƒ¡ãƒ¼ãƒ«ãƒ»ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ»SharePoint ã‹ã‚‰æƒ…å ±ã‚’åé›†ã—ã¦ãƒ¬ãƒãƒ¼ãƒˆã‚’è¿”ã™ãƒ‡ãƒ¢ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

**Agent365 SDK ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰å®Ÿè£…**: [microsoft/Agent365-Samples](https://github.com/microsoft/Agent365-Samples) ã® enterprise æ©Ÿèƒ½ï¼ˆobservabilityã€toolingã€notificationsï¼‰ã‚’çµ±åˆã—ã¤ã¤ã€Ollama ãªã©ã®ãƒ­ãƒ¼ã‚«ãƒ« LLM ã«ã‚‚å¯¾å¿œã—ãŸå®Ÿè£…ã§ã™ã€‚

### ğŸ¯ ãƒ‡ãƒ¢ã§è¦‹ã›ã‚‹ãƒã‚¤ãƒ³ãƒˆ

- âœ… **Agent Identity ã«ã‚ˆã‚‹å®‰å…¨ãªèªè¨¼**ï¼ˆå°‚ç”¨ãƒ¡ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹ã‚’æŒã¤ï¼‰
- âœ… **Teams ã®é€šçŸ¥ãƒãƒ£ãƒãƒ«ã§ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒäººé–“ã®ã‚ˆã†ã«è¿”ä¿¡**
- âœ… **MCPï¼ˆModel Context Protocolï¼‰çµŒç”±ã§ M365 ãƒ‡ãƒ¼ã‚¿ã‚’å®‰å…¨ã«å–å¾—**
- âœ… **OpenTelemetry ã«ã‚ˆã‚‹è¦³æ¸¬æ€§**ï¼ˆãƒˆãƒ¬ãƒ¼ã‚¹ãƒ»ãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼‰ã‚’ç®¡ç†è€…ãŒç¢ºèª
- âœ… **Agent365 SDK ãƒ‘ã‚¿ãƒ¼ãƒ³**: IChatClient middleware chain (Function Invocation + OpenTelemetry)
- âœ… **ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚°ãƒ¬ãƒ¼ãƒ‰ã® Agent Storage ã¨ Transcript ãƒ­ã‚®ãƒ³ã‚°**
- âœ… **Adaptive Cards ã«ã‚ˆã‚‹è¦–è¦šçš„ãªå¿œç­”**ï¼ˆè¦‹ã‚„ã™ãã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãª UXï¼‰
- âœ… **Microsoft Search API ã«ã‚ˆã‚‹é«˜åº¦ãª SharePoint æ¤œç´¢**ï¼ˆæ—¥ä»˜ç¯„å›²ãƒ»ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¯¾å¿œï¼‰

### ğŸ’¼ é¡§å®¢ä¾¡å€¤

- ã€ŒCopilot ã§ã¯ãªã __è‡ªç¤¾å°‚ç”¨ã®æ¥­å‹™ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ__ã€ã‚’ Teams ã«è‡ªç„¶ã«çµ„ã¿è¾¼ã‚ã‚‹
- ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ãŒ **ã‚¬ãƒãƒŠãƒ³ã‚¹ä¸‹**ã§ã‚ã‚‹ã“ã¨ã‚’å¼·èª¿ã§ãã‚‹
- **GitHub Models ã§å®Œå…¨ç„¡æ–™** ã¾ãŸã¯ Ollama ãªã©ã® **ãƒ­ãƒ¼ã‚«ãƒ« LLM** ã«ã‚‚å¯¾å¿œã—ã€ã‚³ã‚¹ãƒˆã¨ã‚¯ãƒ©ã‚¦ãƒ‰ä¾å­˜ã‚’æœ€å°åŒ–

---

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Microsoft Teams                         â”‚
â”‚               ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ @ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã§å•ã„åˆã‚ã›                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ Bot Framework
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å–¶æ¥­æ”¯æ´ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ (.NET 10)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  LLM Provider (åˆ‡æ›¿å¯èƒ½) + Agent365 Middleware       â”‚   â”‚
â”‚  â”‚  - GitHub Models (æ¨å¥¨ãƒ»ç„¡æ–™)                         â”‚   â”‚
â”‚  â”‚  - Ollama (ãƒ­ãƒ¼ã‚«ãƒ«)                                  â”‚   â”‚
â”‚  â”‚  - Azure OpenAI                                       â”‚   â”‚
â”‚  â”‚  [IChatClient â†’ Builder â†’ UseFunctionInvocation()    â”‚   â”‚
â”‚  â”‚   â†’ UseOpenTelemetry() â†’ Build()]                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  MCP Tools (M365 ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹)                       â”‚   â”‚
â”‚  â”‚  - Outlook ãƒ¡ãƒ¼ãƒ«æ¤œç´¢ï¼ˆGraph APIï¼‰                     â”‚   â”‚
â”‚  â”‚  - Outlook ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æ¤œç´¢ï¼ˆGraph APIï¼‰                 â”‚   â”‚
â”‚  â”‚  - SharePoint ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ¤œç´¢ï¼ˆMicrosoft Search APIï¼‰ â”‚   â”‚
â”‚  â”‚  - Teams ãƒãƒ£ãƒƒãƒˆæ¤œç´¢ï¼ˆGraph APIï¼‰                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Adaptive Cards ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°                          â”‚   â”‚
â”‚  â”‚  - å–¶æ¥­ã‚µãƒãƒªãƒ¼ã‚«ãƒ¼ãƒ‰ï¼ˆæ§‹é€ åŒ–è¡¨ç¤ºï¼‰                     â”‚   â”‚
â”‚  â”‚  - ã‚¨ãƒ©ãƒ¼ã‚«ãƒ¼ãƒ‰ï¼ˆè¦–è¦šçš„ãªã‚¨ãƒ©ãƒ¼é€šçŸ¥ï¼‰                   â”‚   â”‚
â”‚  â”‚  - ã‚¦ã‚§ãƒ«ã‚«ãƒ ã‚«ãƒ¼ãƒ‰ï¼ˆåˆå›ã‚¬ã‚¤ãƒ€ãƒ³ã‚¹ï¼‰                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Agent365 SDK çµ±åˆ                                    â”‚   â”‚
â”‚  â”‚  - Observability (AgentMetrics)                      â”‚   â”‚
â”‚  â”‚  - Tooling Extensions                                â”‚   â”‚
â”‚  â”‚  - Notifications (beta)                              â”‚   â”‚
â”‚  â”‚  - Storage + Transcript                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  OpenTelemetry                                       â”‚   â”‚
â”‚  â”‚  - ãƒˆãƒ¬ãƒ¼ã‚¹ï¼ˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ï¼‰                           â”‚   â”‚
â”‚  â”‚  - ãƒ¡ãƒˆãƒªã‚¯ã‚¹                                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ Agent Identity (App-only)
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Microsoft 365 / Graph API                      â”‚
â”‚     - Outlook   - Calendar   - SharePoint   - Teams         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### å¿…è¦ãªç’°å¢ƒ

- âœ… **.NET 10 SDK**
- âœ… **GitHub Models** (æ¨å¥¨ãƒ»ç„¡æ–™) ã¾ãŸã¯ Ollama / Azure OpenAI
- âœ… **Dev Tunnel CLI** (Microsoft æ¨å¥¨) ã¾ãŸã¯ ngrok
- âœ… **Microsoft 365 é–‹ç™ºè€…ãƒ†ãƒŠãƒ³ãƒˆ**ï¼ˆæ¨å¥¨ï¼‰

### 0. Dev Tunnel ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆæ¨å¥¨ï¼‰

**Dev Tunnel ã¯ ngrok ã®ä»£æ›¿ã¨ã—ã¦ Microsoft ãŒæä¾›ã™ã‚‹é–‹ç™ºç”¨ãƒˆãƒ³ãƒãƒ«ã‚µãƒ¼ãƒ“ã‚¹ã§ã€å›ºå®š URL ã®åˆ©ç”¨ãŒå¯èƒ½ã§ã™ã€‚**

#### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# macOS / Linux
curl -sL https://aka.ms/DevTunnelCliInstall | bash

# ã¾ãŸã¯ Homebrew (macOS)
brew install devtunnel

# Windows
winget install Microsoft.devtunnel
```

#### åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# Microsoft ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³
devtunnel user login

# å›ºå®šãƒˆãƒ³ãƒãƒ«ã‚’ä½œæˆï¼ˆåˆå›ã®ã¿ï¼‰
devtunnel create sales-support-agent --allow-anonymous

# ãƒˆãƒ³ãƒãƒ«æƒ…å ±ã‚’ç¢ºèª
devtunnel list
```

**å‡ºåŠ›ä¾‹:**
```
Tunnel ID: abc123xyz
Tunnel Name: sales-support-agent
Access: Anonymous
```

#### ãƒˆãƒ³ãƒãƒ«èµ·å‹•

```bash
# ãƒãƒ¼ãƒˆ 5001 (HTTPS) ã«ãƒˆãƒ³ãƒãƒ«ã‚’ä½œæˆã—ã¦èµ·å‹•
devtunnel port create sales-support-agent -p 5001

# ãƒˆãƒ³ãƒãƒ«ã‚’ãƒ›ã‚¹ãƒˆï¼ˆèµ·å‹•ï¼‰
devtunnel host sales-support-agent
```

**å›ºå®š URL ãŒè¡¨ç¤ºã•ã‚Œã¾ã™:**
```
Connect via browser: https://abc123xyz-5001.euw.devtunnels.ms
Inspect via browser: https://abc123xyz-5001-inspect.euw.devtunnels.ms
```

ã“ã® URL (`https://abc123xyz-5001.euw.devtunnels.ms`) ã¯ **å›ºå®š** ã§ã€ãƒˆãƒ³ãƒãƒ«ã‚’å‰Šé™¤ã—ãªã„é™ã‚Šå¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚

#### ãƒˆãƒ³ãƒãƒ«ç®¡ç†ã‚³ãƒãƒ³ãƒ‰

```bash
# ãƒˆãƒ³ãƒãƒ«ä¸€è¦§
devtunnel list

# ãƒˆãƒ³ãƒãƒ«å‰Šé™¤
devtunnel delete sales-support-agent

# ãƒ˜ãƒ«ãƒ—
devtunnel --help
```

### 0. GitHub Models ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆæ¨å¥¨ãƒ»ç„¡æ–™ï¼‰

**GitHub Models ã¯å®Œå…¨ç„¡æ–™ã§ GPT-4o, GPT-4o-mini, Llama ãªã©ã®æœ€æ–°ãƒ¢ãƒ‡ãƒ«ã‚’åˆ©ç”¨ã§ãã¾ã™ã€‚**

#### Personal Access Token (PAT) ã®ä½œæˆ

1. [GitHub Settings â†’ Tokens](https://github.com/settings/tokens) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. **Generate new token** â†’ **Generate new token (classic)** ã‚’é¸æŠ
3. Token ã®è¨­å®š:
   - **Note**: `SalesSupportAgent - GitHub Models`
   - **Expiration**: ä»»æ„ï¼ˆæ¨å¥¨: 90 daysï¼‰
   - **Select scopes**: `models` ã«ãƒã‚§ãƒƒã‚¯ âœ…
4. **Generate token** ã‚’ã‚¯ãƒªãƒƒã‚¯
5. è¡¨ç¤ºã•ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’ã‚³ãƒ”ãƒ¼ï¼ˆ**1åº¦ã—ã‹è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“**ï¼‰

#### åˆ©ç”¨å¯èƒ½ãªãƒ¢ãƒ‡ãƒ«

- `openai/gpt-4o` - æœ€æ–°ã® GPT-4oï¼ˆé«˜æ€§èƒ½ï¼‰
- `openai/gpt-4o-mini` - GPT-4o miniï¼ˆé«˜é€Ÿãƒ»ä½ã‚³ã‚¹ãƒˆï¼‰
- `meta-llama/Llama-3.2-90B-Vision-Instruct` - Meta Llama 3.2 90B
- `deepseek/deepseek-r1` - DeepSeek R1
- ãã®ä»–å¤šæ•°: [GitHub Marketplace](https://github.com/marketplace?type=models)

#### è¨­å®šæ–¹æ³•

[appsettings.json](SalesSupportAgent/appsettings.json) ã‚’ç·¨é›†:

```json
{
  "LLM": {
    "Provider": "GitHubModels",
    "GitHubModels": {
      "Token": "ghp_your_personal_access_token_here",
      "ModelName": "openai/gpt-4o-mini"
    }
  }
}
```

ã¾ãŸã¯ç’°å¢ƒå¤‰æ•°ã§è¨­å®š:

```bash
export LLM__Provider=GitHubModels
export LLM__GitHubModels__Token=ghp_your_token
export LLM__GitHubModels__ModelName=openai/gpt-4o-mini
```

### 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
cd /path/to/POC-Agent365SDK-TeamsAgent/SalesSupportAgent

# ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
cp .env.sample .env

# .env ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã¦GitHub Models ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¨­å®š
# LLM__Provider=GitHubModels
# LLM__GitHubModels__Token=ghp_your_token_here
# LLM__GitHubModels__ModelName=openai/gpt-4o-mini
```

### 2. ãƒ“ãƒ«ãƒ‰ï¼†å®Ÿè¡Œ

```bash
# ãƒ“ãƒ«ãƒ‰
dotnet build

# å®Ÿè¡Œ
dotnet run
```

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ `https://localhost:5001` ã§èµ·å‹•ã—ã¾ã™ã€‚

### 3. å‹•ä½œç¢ºèªï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆï¼‰

```bash
# ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
curl https://localhost:5001/health

# ç›´æ¥ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå‘¼ã³å‡ºã—
curl -X POST https://localhost:5001/api/sales-summary \
  -H "Content-Type: application/json" \
  -d '{"query":"ä»Šé€±ã®å•†è«‡ã‚µãƒãƒªã‚’æ•™ãˆã¦"}'
```

---

## ğŸ”§ è¨­å®š

### LLM ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®åˆ‡ã‚Šæ›¿ãˆ

[appsettings.json](SalesSupportAgent/appsettings.json) ã¾ãŸã¯ `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã§è¨­å®š:
#### GitHub Modelsï¼ˆæ¨å¥¨ãƒ»ç„¡æ–™ï¼‰

```json
{
  "LLM": {
    "Provider": "GitHubModels",
    "GitHubModels": {
      "Token": "ghp_your_personal_access_token",
      "ModelName": "openai/gpt-4o-mini"
    }
  }
}
```

#### Ollamaï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰

```json
{
  "LLM": {
    "Provider": "Ollama",
    "Ollama": {
      "Endpoint": "http://localhost:11434",
      "ModelName": "qwen2.5:latest"
    }
  }
}
```

#### Azure OpenAI

```json
{
  "LLM": {
    "Provider": "AzureOpenAI",
    "AzureOpenAI": {
      "Endpoint": "https://your-resource.openai.azure.com",
      "DeploymentName": "gpt-4o",
      "ApiKey": "your-api-key"
    }
  }
}
```

### Microsoft 365 (Graph API) æ¥ç¶š

**Agent Identity** ã‚’è¨­å®šã™ã‚‹ã«ã¯ã€Azure Portal ã§ä»¥ä¸‹ã®æ‰‹é †ã‚’å®Ÿè¡Œ:

1. **Azure Portal** â†’ **Microsoft Entra ID** â†’ **ã‚¢ãƒ—ãƒªç™»éŒ²**
2. **æ–°è¦ç™»éŒ²**
   - åå‰: `SalesSupportAgent`
   - ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ç¨®é¡: `ã“ã®çµ„ç¹”ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã¿`
3. **è¨¼æ˜æ›¸ã¨ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ** â†’ **æ–°ã—ã„ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ**
4. **APIã®ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯** â†’ **ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã®è¿½åŠ ** â†’ **Microsoft Graph** â†’ **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è¨±å¯**
   - `Mail.Read` - Outlook ãƒ¡ãƒ¼ãƒ«æ¤œç´¢
   - `Calendars.Read` - ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼äºˆå®šæ¤œç´¢
   - `Files.Read.All` - SharePoint ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¯ã‚»ã‚¹
   - `Sites.Read.All` - SharePoint ã‚µã‚¤ãƒˆæ¤œç´¢ï¼ˆMicrosoft Search APIï¼‰
   - `ChannelMessage.Read.All` - Teams ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ¤œç´¢
   - `Team.ReadBasic.All` - Teams åŸºæœ¬æƒ…å ±å–å¾—
5. **ç®¡ç†è€…ã®åŒæ„ã‚’ä»˜ä¸**

[appsettings.json](SalesSupportAgent/appsettings.json) ã«è¨­å®š:

```json
{
  "M365": {
    "TenantId": "your-tenant-id",
    "ClientId": "your-client-id",
    "ClientSecret": "your-client-secret"
  }
}
```

### Teams Bot æ¥ç¶š

#### 1. Azure Bot Service ã®ä½œæˆ

1. **Azure Portal** â†’ **Bot Services** â†’ **ä½œæˆ**
2. **Azure Bot** ã‚’é¸æŠ
   - Bot ãƒãƒ³ãƒ‰ãƒ«: `SalesSupportAgent` (ä¸€æ„ã®åå‰)
   - ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ»ãƒªã‚½ãƒ¼ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ã‚’é¸æŠ
   - ä¾¡æ ¼ãƒ¬ãƒ™ãƒ«: **F0 (Free)**
3. **Microsoft App ID**: **ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆ** ã‚’é¸æŠ
4. ä½œæˆå®Œäº†å¾Œã€**æ§‹æˆ** â†’ **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚° ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ** ã‚’è¨­å®š
   - Dev Tunnel URL ã‚’ä½¿ç”¨: `https://your-tunnel-id-5001.region.devtunnels.ms/api/messages`
   - ã¾ãŸã¯ ngrok: `https://your-ngrok-url.ngrok.io/api/messages`

#### 2. App ID ã¨ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã®å–å¾—

1. **æ§‹æˆ** â†’ **Microsoft App ID** ã‚’ã‚¯ãƒªãƒƒã‚¯
2. **è¨¼æ˜æ›¸ã¨ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ** â†’ **æ–°ã—ã„ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ**
   - èª¬æ˜: `SalesSupportAgent Secret`
   - æœ‰åŠ¹æœŸé™: ä»»æ„ï¼ˆæ¨å¥¨: 24ãƒ¶æœˆï¼‰
3. **ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆå€¤** ã‚’ã‚³ãƒ”ãƒ¼ï¼ˆ1åº¦ã®ã¿è¡¨ç¤ºã•ã‚Œã¾ã™ï¼‰
4. **æ¦‚è¦** â†’ **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ (ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ) ID** ã‚’ã‚³ãƒ”ãƒ¼

#### 3. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š

[appsettings.json](SalesSupportAgent/appsettings.json) ã«è¨­å®š:

```json
{
  "Bot": {
    "MicrosoftAppType": "MultiTenant",
    "MicrosoftAppId": "your-app-id-here",
    "MicrosoftAppPassword": "your-app-secret-here",
    "MicrosoftAppTenantId": ""
  }
}
```

#### 4. Dev Tunnel ã§ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼ã‚’å…¬é–‹

```bash
# åˆ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•
cd /Volumes/TK3SSD/GitHub/POC-Agent365SDK-TeamsAgent/SalesSupportAgent
dotnet run

# åˆ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ Dev Tunnel ã‚’èµ·å‹•
devtunnel host sales-support-agent

# è¡¨ç¤ºã•ã‚ŒãŸ URL ã‚’ Bot ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚° ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«è¨­å®š
# ä¾‹: https://abc123xyz-5001.euw.devtunnels.ms/api/messages
```

**ngrok ã‚’ä½¿ã†å ´åˆï¼ˆéæ¨å¥¨ï¼‰:**

```bash
ngrok http https://localhost:5001
# è¡¨ç¤ºã•ã‚ŒãŸ URL ã‚’ä½¿ç”¨
```

#### 5. Teams ã«ãƒœãƒƒãƒˆã‚’è¿½åŠ 

**æ–¹æ³• A: Developer Portal ä½¿ç”¨ï¼ˆæ¨å¥¨ï¼‰**

1. [Teams Developer Portal](https://dev.teams.microsoft.com/) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. **Apps** â†’ **New app**
   - App name: `å–¶æ¥­æ”¯æ´ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ`
   - Short description: `å•†è«‡ã‚µãƒãƒªã‚’è‡ªå‹•ç”Ÿæˆ`
3. **App features** â†’ **Bot**
   - Select: **Existing bot**
   - Bot ID: Azure ã§ä½œæˆã—ãŸ App ID ã‚’å…¥åŠ›
4. **Bot endpoint address**: Azure Bot ã®è¨­å®šã¨åŒã˜
5. **Personal** ãŠã‚ˆã³ **Team** ã‚¹ã‚³ãƒ¼ãƒ—ã‚’æœ‰åŠ¹åŒ–
6. **Publish** â†’ **Download the app package**
7. Teams â†’ **Apps** â†’ **Manage your apps** â†’ **Upload a custom app** â†’ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸ zip ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

**æ–¹æ³• B: App Studio ä½¿ç”¨**

1. Teams ã§ **App Studio** ã‚’æ¤œç´¢ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
2. **Manifest editor** â†’ **Create a new app**
3. ä¸Šè¨˜ã¨åŒæ§˜ã®æ‰‹é †ã§ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã‚’ä½œæˆ
4. **Test and distribute** â†’ **Install** ã§ãƒ†ã‚¹ãƒˆ

#### 6. å‹•ä½œç¢ºèª

1. Teams ã§ãƒœãƒƒãƒˆã‚’æ¤œç´¢: `å–¶æ¥­æ”¯æ´ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ`
2. ãƒãƒ£ãƒƒãƒˆã‚’é–‹å§‹
3. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡: `ã“ã‚“ã«ã¡ã¯`
4. ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¿”ã£ã¦ãã‚‹ã“ã¨ã‚’ç¢ºèª
5. `ä»Šé€±ã®å•†è«‡ã‚µãƒãƒªã‚’æ•™ãˆã¦` ã¨é€ä¿¡ã—ã¦ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ãƒ†ã‚¹ãƒˆ

---     # Agent365 middleware çµ±åˆ
â”‚   â”‚   â”œâ”€â”€ OllamaProvider.cs       # Agent365 middleware çµ±åˆ
â”‚   â”‚   â””â”€â”€ AzureOpenAIProvider.cs  # Agent365 middleware çµ±åˆ
â”‚   â”œâ”€â”€ MCP/                        # M365 ãƒ„ãƒ¼ãƒ« (MCP)
â”‚   â”‚   â””â”€â”€ McpTools/
â”‚   â”‚       â”œâ”€â”€ OutlookEmailTool.cs
â”‚   â”‚       â”œâ”€â”€ OutlookCalendarTool.cs
â”‚   â”‚       â”œâ”€â”€ SharePointTool.cs
â”‚   â”‚       â””â”€â”€ TeamsMessageTool.cs
â”‚   â””â”€â”€ Agent/
â”‚       â””â”€â”€ SalesAgent.cs           # ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæœ¬ä½“
â”œâ”€â”€ Bot/
â”‚   â”œâ”€â”€ TeamsBot.cs                 # Teams Bot å®Ÿè£…
â”‚   â”œâ”€â”€ BotController.cs            # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â”‚   â””â”€â”€ AdapterWithErrorHandler.cs  # ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
â”œâ”€â”€ Configuration/                  # è¨­å®šã‚¯ãƒ©ã‚¹
â”‚   â”œâ”€â”€ LLMSettings.cs
â”‚   â”œâ”€â”€ M365Settings.cs
â”‚   â””â”€â”€ BotSettings.cs
â”œâ”€â”€ Telemetry/                      # Agent365 è¦³æ¸¬æ€§
â”‚   â””â”€â”€ AgentMetrics.cs             # ActivitySource, Meter, Counter, Histogram
â”‚       â””â”€â”€ SalesAgent.cs           # ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæœ¬ä½“
â”œâ”€â”€ Bot/
â”‚   â”œâ”€â”€ TeamsBot.cs                 # Teams Bot å®Ÿè£…
â”‚   â”œâ”€â”€ BotController.cs            # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â”‚   â””â”€â”€ AdapterWithErrorHandler.cs  # ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
â”œâ”€â”€ Configuration/                  # è¨­å®šã‚¯ãƒ©ã‚¹
â”‚   â”œâ”€â”€ LLMSettings.cs
â”‚   â”œâ”€â”€ M365Settings.cs
â”‚   â””â”€â”€ BotSettings.cs
â”œâ”€â”€ Models/
â”‚   â””â”€â”€ SalesSummaryModels.cs       # ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¢ãƒ‡ãƒ«
â”œâ”€â”€ Program.cs                      # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ
â””â”€â”€ appsettings.json                # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
```
- **ä»£æ›¿**: Ollama ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ `LLM__Provider=Ollama` ã«å¤‰æ›´

### Dev Tunnel / ngrok ãŒæ¥ç¶šã§ããªã„

**Dev Tunnel ã®å ´åˆ:**
- `devtunnel user login` ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ã‹ç¢ºèª
- `devtunnel host sales-support-agent` ãŒå®Ÿè¡Œä¸­ã‹ç¢ºèª
- ãƒˆãƒ³ãƒãƒ« URL ãŒæ­£ã—ã Azure Bot ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- `--allow-anonymous` ãƒ•ãƒ©ã‚°ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
Dev Tunnel ã¾ãŸã¯ ngrok ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
- Bot ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒæ­£ã—ã„ã‹ç¢ºèª
  - Dev Tunnel: `https://your-tunnel-id-5001.region.devtunnels.ms/api/messages`
  - ngrok: `https://your-ngrok-url.ngrok.io/api/messages`
- Bot ã® App ID ã¨ Password ãŒæ­£ã—ã„ã‹ç¢ºèª
- Teams ã«ãƒœãƒƒãƒˆãŒæ­£ã—ãã‚µã‚¤ãƒ‰ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- Azure Portal ã® Bot Service ã§ã€ŒTest in Web Chatã€ã‚’è©¦ã™
- `dotnet run` ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒèµ·å‹•ã—Bot è¨­å®šã‚’æ›´æ–°

---

## ğŸ” ãƒ‡ãƒ¢ã‚·ãƒŠãƒªã‚ª

### ã‚·ãƒŠãƒªã‚ª 1: ä»Šé€±ã®å•†è«‡ã‚µãƒãƒª

Teams ã§ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³:

```
@å–¶æ¥­æ”¯æ´ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ä»Šé€±ã®å•†è«‡ã‚µãƒãƒªã‚’æ•™ãˆã¦
```

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒä»¥ä¸‹ã®æƒ…å ±ã‚’åé›†:
- ğŸ“§ Outlook: å•†è«‡é–¢é€£ãƒ¡ãƒ¼ãƒ«
- ğŸ“… Calendar: å•†è«‡äºˆå®š
- ğŸ“ SharePoint: ææ¡ˆæ›¸ãƒ»è¦‹ç©æ›¸ï¼ˆMicrosoft Search API ã§æ—¥ä»˜ç¯„å›²æ¤œç´¢ï¼‰
- ğŸ“¢ Teams: å•†è«‡ãƒãƒ£ãƒãƒ«ã®ä¼šè©±

**å¿œç­”ã¯ Adaptive Card ã§è¦–è¦šçš„ã«è¡¨ç¤ºã•ã‚Œã¾ã™:**
- ğŸ“Š æ§‹é€ åŒ–ã•ã‚ŒãŸã‚µãƒãƒªãƒ¼è¡¨ç¤º
- ğŸ¨ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã”ã¨ã«æ•´ç†ã•ã‚ŒãŸè¦‹ã‚„ã™ã„ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
- â±ï¸ ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—è¡¨ç¤º
- ğŸ¤– LLM ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼æƒ…å ±

ãã—ã¦ã€çµ±åˆã•ã‚ŒãŸãƒ¬ãƒãƒ¼ãƒˆã‚’è¿”ã—ã¾ã™ã€‚

### ã‚·ãƒŠãƒªã‚ª 2: ç‰¹å®šã®é¡§å®¢ã«é–¢ã™ã‚‹æƒ…å ±

```
@å–¶æ¥­æ”¯æ´ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã€‡ã€‡ç¤¾ã«é–¢ã™ã‚‹æƒ…å ±ã‚’ã¾ã¨ã‚ã¦
```

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒé¡§å®¢åã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ã¦æƒ…å ±ã‚’åé›†ã—ã¾ã™ã€‚

---

## ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ã‚¬ãƒãƒŠãƒ³ã‚¹

æœ¬ãƒ‡ãƒ¢ã§ã¯ä»¥ä¸‹ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’å®Ÿè£…:

- âœ… **Agent Identity**: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å°‚ç”¨ã® ID ã‚’ä½¿ç”¨ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™ã‚’å§”ä»»ã—ãªã„
- âœ… **æœ€å°æ¨©é™ã®åŸå‰‡**: å¿…è¦æœ€å°é™ã® Graph API æ¨©é™ã®ã¿ã‚’ä»˜ä¸
- âœ… **ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆç®¡ç†**: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã¯ç’°å¢ƒå¤‰æ•°ã§ç®¡ç†
- âœ… **OpenTelemetry**: ã™ã¹ã¦ã® API å‘¼ã³å‡ºã—ã‚’è¦³æ¸¬å¯èƒ½
- âœ… GitHub Models ã«æ¥ç¶šã§ããªã„

- Personal Access Token (PAT) ãŒæ­£ã—ã„ã‹ç¢ºèª
- PAT ã« `models` ã‚¹ã‚³ãƒ¼ãƒ—ãŒä»˜ä¸ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- ãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚Œã¦ã„ãªã„ã‹ç¢ºèª
- ãƒ¢ãƒ‡ãƒ«åãŒæ­£ã—ã„ã‹ç¢ºèªï¼ˆä¾‹: `openai/gpt-4o-mini`ï¼‰
- [GitHub Marketplace](https://github.com/marketplace?type=models) ã§ãƒ¢ãƒ‡ãƒ«ã®åˆ©ç”¨å¯èƒ½æ€§ã‚’ç¢ºèª

### **èªè¨¼ã®ä¸€å…ƒç®¡ç†**: GraphServiceClient ã‚’ DI ã‚³ãƒ³ãƒ†ãƒŠã§ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ç®¡ç†
- âœ… **Managed Identity å¯¾å¿œ**: Azure ç’°å¢ƒã§ã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒ¬ã‚¹èªè¨¼ã«å¯¾å¿œ
- âœ… **ãƒˆãƒ¼ã‚¯ãƒ³ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœ€é©åŒ–**: èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã®å†åˆ©ç”¨ã«ã‚ˆã‚‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š

### èªè¨¼ãƒ¢ãƒ¼ãƒ‰

#### ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ
```json
{
  "M365": {
    "TenantId": "your-tenant-id",
    "ClientId": "your-client-id",
    "ClientSecret": "your-client-secret",
    "UseManagedIdentity": false
  }
}
```

#### Azure æœ¬ç•ªç’°å¢ƒ (Managed Identity)
```json
{
  "M365": {
    "ClientId": "your-client-id",
    "UseManagedIdentity": true
  }
}
```

Managed Identity ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆç®¡ç†ãŒä¸è¦ã«ãªã‚Šã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãŒå¤§å¹…ã«å‘ä¸Šã—ã¾ã™ã€‚

---

## ğŸ“Š è¦³æ¸¬æ€§ (OpenTelemetry)

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ OpenTelemetry ã‚’çµ±åˆã—ã€ä»¥ä¸‹ã®æƒ…å ±ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›:

- **ãƒˆãƒ¬ãƒ¼ã‚¹**: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œãƒ•ãƒ­ãƒ¼
- **ãƒ¡ãƒˆãƒªã‚¯ã‚¹**: å‡¦ç†æ™‚é–“ã€API å‘¼ã³å‡ºã—å›æ•°
- **ãƒ­ã‚°**: ã‚¨ãƒ©ãƒ¼ã€è­¦å‘Šã€æƒ…å ±ãƒ­ã‚°

æœ¬ç•ªç’°å¢ƒã§ã¯ã€Azure Monitor ã‚„ãã®ä»–ã® observability ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«é€ä¿¡å¯èƒ½ã§ã™ã€‚

---

## âš ï¸ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### GitHub Models ã«æ¥ç¶šã§ããªã„

- Personal Access Token (PAT) ãŒæ­£ã—ã„ã‹ç¢ºèª
- PAT ã« `models` ã‚¹ã‚³ãƒ¼ãƒ—ãŒä»˜ä¸ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- ãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚Œã¦ã„ãªã„ã‹ç¢ºèª
- ãƒ¢ãƒ‡ãƒ«åãŒæ­£ã—ã„ã‹ç¢ºèªï¼ˆä¾‹: `openai/gpt-4o-mini`ï¼‰
- [GitHub Marketplace](https://github.com/marketplace?type=models) ã§ãƒ¢ãƒ‡ãƒ«ã®åˆ©ç”¨å¯èƒ½æ€§ã‚’ç¢ºèª

### Ollama ã«æ¥ç¶šã§ããªã„

- Ollama ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª (`ollama serve`)
- ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ URL ãŒæ­£ã—ã„ã‹ç¢ºèªï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: `http://localhost:11434`ï¼‰
- ãƒ¢ãƒ‡ãƒ«ãŒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª (`ollama list`)

### M365 ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„

- Agent Identity ã®æ¨©é™ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- ç®¡ç†è€…ã®åŒæ„ãŒä»˜ä¸ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- `M365__TenantId`, `M365__ClientId`, `M365__ClientSecret` ãŒæ­£ã—ã„ã‹ç¢ºèª

### Teams Bot ãŒå¿œç­”ã—ãªã„

- Dev Tunnel ã¾ãŸã¯ ngrok ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
- Bot ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒæ­£ã—ã„ã‹ç¢ºèª
  - Dev Tunnel: `https://your-tunnel-id-5001.region.devtunnels.ms/api/messages`
  - ngrok: `https://your-ngrok-url.ngrok.io/api/messages`
- Bot ã® App ID ã¨ Password ãŒæ­£ã—ã„ã‹ç¢ºèª
- Teams ã«ãƒœãƒƒãƒˆãŒæ­£ã—ãã‚µã‚¤ãƒ‰ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- Azure Portal ã® Bot Service ã§ã€ŒTest in Web Chatã€ã‚’è©¦ã™
- `dotnet run` ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª

---

## ğŸ“š è¿½åŠ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [Dev Tunnel ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰](docs/DEV-TUNNEL-SETUP.md) - å›ºå®š URL ã§ã®ãƒˆãƒ³ãƒãƒ«ä½œæˆ
- [GitHub Models ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰](docs/GITHUB-MODELS-SETUP.md) - ç„¡æ–™ã§æœ€æ–° AI ãƒ¢ãƒ‡ãƒ«ã‚’åˆ©ç”¨
- [Adaptive Cards å®Ÿè£…ã‚¬ã‚¤ãƒ‰](docs/ADAPTIVE-CARDS-GUIDE.md) - è¦–è¦šçš„ãªå¿œç­”ã‚«ãƒ¼ãƒ‰ã®ä½œæˆæ–¹æ³•
- [SharePoint Search API ã‚¬ã‚¤ãƒ‰](docs/SHAREPOINT-SEARCH-API.md) - Microsoft Search API ã«ã‚ˆã‚‹é«˜åº¦ãªæ¤œç´¢
- [Agent Identity è¨­å®šã‚¬ã‚¤ãƒ‰](docs/AGENT-IDENTITY-SETUP.md) - Microsoft 365 èªè¨¼è¨­å®šï¼ˆä½œæˆäºˆå®šï¼‰
- [Teams Bot ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ](docs/TEAMS-MANIFEST.md) - Teams ã‚¢ãƒ—ãƒªè¨­å®šï¼ˆä½œæˆäºˆå®šï¼‰

---

## ğŸ“ TODO / ä»Šå¾Œã®æ”¹å–„

### âœ… å®Œäº†

- [x] Dev Tunnel å›ºå®š URL ã‚µãƒãƒ¼ãƒˆ
- [x] ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼ã®ä¿®æ­£ (Microsoft.Extensions.AI.OpenAI äº’æ›æ€§)
- [x] **Agent365 SDK ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰å®Ÿè£…å®Œäº†** (2025-01)
  - Microsoft.Agents.A365.Observability.Extensions.AgentFramework (beta)
  - Microsoft.Agents.A365.Tooling.Extensions.AgentFramework (beta)
  - Microsoft.Agents.A365.Notifications (beta)
  - Microsoft.Agents.Storage + Transcript
  - IChatClient middleware chain (UseFunctionInvocation + UseOpenTelemetry)
  - AgentMetrics telemetry (ActivitySource, Meter, Counter, Histogram)
- [x] **èªè¨¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ”¹å–„** (2026-02)
  - GraphServiceClient ã® DI ã‚³ãƒ³ãƒ†ãƒŠç®¡ç†
  - TokenCredential ã®ä¸€å…ƒåŒ–ï¼ˆClientSecretCredential / DefaultAzureCredentialï¼‰
  - Managed Identity å¯¾å¿œï¼ˆAzure ç’°å¢ƒã§ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒ¬ã‚¹èªè¨¼ï¼‰
  - ãƒˆãƒ¼ã‚¯ãƒ³ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœ€é©åŒ–ã¨ãƒªãƒˆãƒ©ã‚¤ãƒãƒªã‚·ãƒ¼
- [x] **SharePoint Search API ã®å®Ÿè£…** (2026-02)
  - Microsoft Search API (`/search/query`) ã«ã‚ˆã‚‹é«˜åº¦ãªæ¤œç´¢
  - æ—¥ä»˜ç¯„å›²ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼ˆLastModifiedTimeï¼‰
  - ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ OR æ¤œç´¢å¯¾å¿œ
  - ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆã‚µã‚¤ã‚ºã€æ‹¡å¼µå­ã€æ›´æ–°è€…ï¼‰
- [x] **Adaptive Cards ã§ã®å¿œç­”** (2026-02)
  - å–¶æ¥­ã‚µãƒãƒªãƒ¼ã‚«ãƒ¼ãƒ‰ï¼ˆæ§‹é€ åŒ–è¡¨ç¤ºã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ†å‰²ï¼‰
  - ã‚¨ãƒ©ãƒ¼ã‚«ãƒ¼ãƒ‰ï¼ˆè¦–è¦šçš„ãªã‚¨ãƒ©ãƒ¼é€šçŸ¥ï¼‰
  - ã‚¦ã‚§ãƒ«ã‚«ãƒ ã‚«ãƒ¼ãƒ‰ï¼ˆåˆå›ã‚¬ã‚¤ãƒ€ãƒ³ã‚¹ï¼‰
  - ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãƒ»LLM ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼æƒ…å ±è¡¨ç¤º

### ğŸš§ é€²è¡Œä¸­

ãªã—

### ğŸ“‹ è¨ˆç”»ä¸­

- [ ] å¤šè¨€èªå¯¾å¿œï¼ˆè‹±èªãƒ»æ—¥æœ¬èªåˆ‡ã‚Šæ›¿ãˆï¼‰
- [ ] ã‚«ã‚¹ã‚¿ãƒ  MCP ã‚µãƒ¼ãƒãƒ¼ã®è¿½åŠ 
- [ ] Azure ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ãŸã‚ã® Dockerfile
- [ ] CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­å®šï¼ˆGitHub Actionsï¼‰
- [ ] Application Insights ã¸ã®ç›´æ¥çµ±åˆ
- [ ] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆãƒ»çµ±åˆãƒ†ã‚¹ãƒˆã®è¿½åŠ 

---

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ MIT ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚‚ã¨ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

---

## ğŸ™‹ ã‚µãƒãƒ¼ãƒˆ

è³ªå•ã‚„å•é¡ŒãŒã‚ã‚‹å ´åˆã¯ã€Issue ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

---

**Agent 365 SDK** ã‚’ä½¿ã£ãŸå–¶æ¥­æ”¯æ´ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ãƒ‡ãƒ¢ã‚’ãŠæ¥½ã—ã¿ãã ã•ã„ï¼ ğŸš€
