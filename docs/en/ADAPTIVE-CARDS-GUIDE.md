# Adaptive Cards Implementation Guide

[![æ—¥æœ¬èª](https://img.shields.io/badge/lang-æ—¥æœ¬èª-red.svg)](../ADAPTIVE-CARDS-GUIDE.md)
[![English](https://img.shields.io/badge/lang-English-blue.svg)](ADAPTIVE-CARDS-GUIDE.md)

## ğŸ“‹ Overview

This project uses **Adaptive Cards** for Teams Bot responses. Adaptive Cards is a JSON-based format for creating structured, visually appealing cards that work across various platforms including Microsoft Teams.

## ğŸ¨ Implemented Adaptive Card Types

### 1. Sales Summary Card (`CreateSalesSummaryCard`)

**Purpose**: Visually display sales summaries generated by agent

**Features**:
- ğŸ“Š Header with icon and title
- ğŸ“ Easy-to-read layout divided into sections
- â±ï¸ Timestamp display
- ğŸ¤– LLM provider information

**Sample Output**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š Sales Support Agent - Summary Report â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ## ğŸ“§ Sales-related Emails (5)          â”‚
â”‚ - Subject 1                             â”‚
â”‚ - Subject 2                             â”‚
â”‚                                         â”‚
â”‚ ## ğŸ“… Sales-related Events (3)          â”‚
â”‚ - Event 1                               â”‚
â”‚ - Event 2                               â”‚
â”‚                                         â”‚
â”‚ ğŸ¤– powered by Agent 365 SDK | 2026/02/05â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Code Example**:
```csharp
var cardAttachment = AdaptiveCardHelper.CreateSalesSummaryCard(response.Response);
var reply = MessageFactory.Attachment(cardAttachment);
await turnContext.SendActivityAsync(reply, cancellationToken);
```

### 2. Error Card (`CreateAgentResponseCard` with `isError: true`)

**Purpose**: Display visual notification when errors occur

**Features**:
- âš ï¸ Prominent error display
- ğŸ“ Error details
- ğŸ’¡ Guidance for solutions
- ğŸ¨ Warning color style

**Sample Output**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸ An error occurred                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ **Error Details:**                       â”‚
â”‚ Microsoft 365 is not configured         â”‚
â”‚                                         â”‚
â”‚ **Solution:**                            â”‚
â”‚ - Check appsettings.json                â”‚
â”‚ - Verify M365 permissions               â”‚
â”‚                                         â”‚
â”‚ âš ï¸ An error occurred.                   â”‚
â”‚ Updated: 2026/02/05 18:30:00            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Welcome Card

**Purpose**: Display guidance on initial connection

**Features**:
- ğŸ‘‹ Friendly greeting
- ğŸ“– Feature explanation
- ğŸ’¬ Specific usage examples
- âš ï¸ Initial setup notes

## ğŸ› ï¸ Adaptive Card Structure

### Basic Composition

```csharp
var card = new AdaptiveCard(new AdaptiveSchemaVersion(1, 5))
{
    Body = new List<AdaptiveElement>
    {
        // Header
        new AdaptiveColumnSet { /* ... */ },
        
        // Separator
        new AdaptiveContainer { Separator = true },
        
        // Main content
        new AdaptiveTextBlock { /* ... */ },
        
        // Footer
        new AdaptiveTextBlock { /* ... */ }
    }
};
```

### Key Elements

#### AdaptiveColumnSet
Create 2-column layout (icon + text)

```csharp
new AdaptiveColumnSet
{
    Columns = new List<AdaptiveColumn>
    {
        new AdaptiveColumn
        {
            Width = AdaptiveColumnWidth.Auto,
            Items = new List<AdaptiveElement>
            {
                new AdaptiveImage { /* icon */ }
            }
        },
        new AdaptiveColumn
        {
            Width = AdaptiveColumnWidth.Stretch,
            Items = new List<AdaptiveElement>
            {
                new AdaptiveTextBlock { /* title */ }
            }
        }
    }
}
```

#### AdaptiveTextBlock
Display text content

```csharp
new AdaptiveTextBlock
{
    Text = "Text to display",
    Weight = AdaptiveTextWeight.Bolder,  // Bold
    Size = AdaptiveTextSize.Large,       // Size
    Wrap = true,                         // Wrap
    Color = AdaptiveTextColor.Default    // Color
}
```

#### AdaptiveContainer
Grouping and separating sections

```csharp
new AdaptiveContainer
{
    Separator = true,                    // Separator line
    Spacing = AdaptiveSpacing.Medium,    // Spacing
    Style = AdaptiveContainerStyle.Attention  // Warning style
}
```

## ğŸ“ Customization Methods

### Add New Card Type

1. **Add new method to AdaptiveCardHelper.cs**

```csharp
public static Attachment CreateCustomCard(string title, string content)
{
    var card = new AdaptiveCard(new AdaptiveSchemaVersion(1, 5))
    {
        Body = new List<AdaptiveElement>
        {
            // Add custom elements
        }
    };

    return new Attachment
    {
        ContentType = AdaptiveCard.ContentType,
        Content = JsonConvert.DeserializeObject(card.ToJson())
    };
}
```

2. **Use in TeamsBot.cs**

```csharp
var customCard = AdaptiveCardHelper.CreateCustomCard("Title", "Content");
var reply = MessageFactory.Attachment(customCard);
await turnContext.SendActivityAsync(reply, cancellationToken);
```

### Style Changes

#### Color Changes
```csharp
Color = AdaptiveTextColor.Accent      // Accent color
Color = AdaptiveTextColor.Good        // Success (green)
Color = AdaptiveTextColor.Warning     // Warning (yellow)
Color = AdaptiveTextColor.Attention   // Error (red)
```

#### Size Changes
```csharp
Size = AdaptiveTextSize.Small
Size = AdaptiveTextSize.Default
Size = AdaptiveTextSize.Medium
Size = AdaptiveTextSize.Large
Size = AdaptiveTextSize.ExtraLarge
```

#### Weight Changes
```csharp
Weight = AdaptiveTextWeight.Lighter
Weight = AdaptiveTextWeight.Default
Weight = AdaptiveTextWeight.Bolder
```

## ğŸ§ª Testing Methods

### Test with Bot Framework Emulator

1. Download Bot Framework Emulator
2. Connect to `http://localhost:5001/api/messages`
3. Send message and verify Adaptive Card

### Test in Teams

1. Create tunnel with Dev Tunnel or ngrok
2. Install Bot in Teams
3. Send message and verify Adaptive Card

### Preview in Designer

Verify and edit JSON in [Adaptive Cards Designer](https://adaptivecards.io/designer/)

## ğŸ“š Reference Links

- [Adaptive Cards Official Documentation](https://adaptivecards.io/)
- [Adaptive Cards Schema](https://adaptivecards.io/explorer/)
- [Bot Framework - Adaptive Cards](https://learn.microsoft.com/microsoftteams/platform/task-modules-and-cards/cards/cards-reference#adaptive-card)
- [Adaptive Cards in Teams](https://learn.microsoft.com/microsoftteams/platform/task-modules-and-cards/cards/design-effective-cards)

## ğŸ’¡ Best Practices

### 1. Responsive Design
- Use `Wrap = true` to wrap text
- Flexible layout with `AdaptiveColumnWidth.Stretch`

### 2. Accessibility
- Don't rely on color alone, supplement with icons and text
- Display footer information subtly with `IsSubtle = true`

### 3. Performance
- Keep card size appropriate (recommended max 28KB)
- Use URL references for images (avoid embedding)

### 4. User Experience
- Display timestamps to show information freshness
- Divide into sections for readability
- Provide specific solutions when errors occur

## ğŸ”§ Troubleshooting

### Adaptive Card Not Displaying

**Cause**: Invalid JSON format
**Solution**: Validate JSON in Adaptive Cards Designer

### Styles Not Applied

**Cause**: Style not supported by Teams
**Solution**: Use only Teams-compatible elements (refer to official documentation)

### Card Too Long

**Cause**: Too much content
**Solution**: Split sections into multiple messages

---

**Build beautiful and functional Teams Bot with Agent 365 SDK + Adaptive Cards!**
